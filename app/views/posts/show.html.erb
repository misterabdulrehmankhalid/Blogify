<%= render "shared/navbar" %>

<% content_for :title, "Showing post" %>

<main class="max-w-3xl mx-auto mt-10 px-4">
  <% if notice.present? %>
    <p class="py-2 px-4 bg-green-50 mb-6 text-green-600 font-medium rounded-md inline-block" id="notice">
      <%= notice %>
    </p>
  <% end %>


  <div class="bg-white shadow-lg rounded-2xl p-8">

    <p class="inline-flex items-center text-gray-700 text-sm mb-4 bg-gray-100 px-3 py-1 rounded-full shadow-sm font-medium">
      <span class="mr-2 text-indigo-600 font-semibold">Posted by:</span>
      <%= @post.user.email.split('@').first.capitalize %>
      <span class="mx-2 text-gray-400">|</span>
      <span class="text-gray-500"><%= @post.created_at.strftime("%b %d, %Y at %I:%M %p") %></span>
    </p>
    <h1 class="text-4xl font-bold text-gray-800 mb-4"><%= @post.title %></h1>

    <!-- Post -->
    <p class="text-gray-700 text-lg leading-relaxed mb-6">
      <%= @post.body %>
    </p>

    <div class="flex flex-col sm:flex-row gap-3">
      <% if can? :update, @post %>
        <%= link_to "Edit Post", edit_post_path(@post), class: "w-full sm:w-auto text-center rounded-lg px-5 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium shadow-md transition duration-200" %>
      <% end %>

      <% if can? :destroy, @post %>

        <%= button_to "Delete Post", @post, method: :delete,
                      form_class: "w-full sm:w-auto",
                      class: "w-full sm:w-auto rounded-lg px-5 py-2.5 bg-red-600 hover:bg-red-500 text-white font-medium shadow-md transition duration-200",
                      data: { turbo_confirm: "Are you sure you want to delete this post?" } %>
      <% end %>

      <%= link_to "Back to Posts", posts_path,
                  class: "w-full sm:w-auto text-center rounded-xl px-5 py-2.5 bg-gradient-to-r from-purple-400 via-indigo-500 to-blue-500 text-white font-semibold shadow-lg hover:scale-105 hover:shadow-xl transition-transform duration-200" %>
    </div>
  </div>



  <!-- Comments -->
  <div class="bg-white shadow-lg rounded-2xl p-8">

    <h2 class="text-2xl font-bold text-gray-800 mb-4">Comments (<%= @post.comments.count %>)</h2>

    <div class="mb-6">
      <%= render 'comments/form', post: @post, comment: Comment.new %>
    </div>

    <% if @post.comments.any? %>
      <div class="space-y-4">
        <%= render @post.comments.order_by(created_at: :desc) %>
      </div>
    <% else %>
      <p class="text-gray-500 italic">No comments yet. Be the first to comment!</p>
    <% end %>

  </div>

</main>
